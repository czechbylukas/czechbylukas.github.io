<!DOCTYPE html>
<html lang="cs">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-1BCW5XQ0X5"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-1BCW5XQ0X5');
    </script>

    <meta charset="UTF-8">
    <title id="page-title">Practice: Past Tense â€“ CzechByLukas</title>

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"
            client="ca-pub-9067674021614925" crossorigin="anonymous"></script>
    <meta name="google-adsense-account" content="ca-pub-9067674021614925">

    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/practice.css">
    <link rel="stylesheet" href="../css/language-selector.css">
</head>

<body class="vocab-page">

<header>
    <h1 id="heading-practice">Practice Past Tense</h1>
    <div id="language-selector-container"></div>
</header>

<main>
    <div class="vocab-container">
        <div id="englishCard" class="card"></div>
        <div id="czechCard" class="card"></div>
    </div>

    <div class="big-buttons">
        <button id="prevBtn"></button>
        <button id="nextBtn"></button>
    </div>

    <div class="progress-wrapper">
        <div class="progress-bar">
            <div id="progress" class="progress"></div>
        </div>
        <div id="progressText" class="progress-text"></div>
    </div>

    <div class="big-buttons">
        <a id="btn-vocab" href="../vocabulary/2_pasttense.html"></a>
        <a id="btn-test" href="../tests/2_pasttense.html"></a>
    </div>

    <div class="small-buttons">
        <a id="btn-home" href="../index.html"></a>
        <a id="btn-exerciseList" href="../exercise/index.html"></a>
    </div>
</main>

<div id="footer-placeholder"></div>

<script>
    fetch("/footer.html")
        .then(response => response.text())
        .then(data => {
            document.getElementById("footer-placeholder").innerHTML = data;
        })
        .catch(error => console.error("Error loading footer:", error));
</script>

<script type="module">
    import { vocab } from "../data/2_pasttense.js";

    // Filter ONLY blocks 1 and 2 as requested
    const filtered = vocab.filter(item => item.block === 1 || item.block === 2 || item.block === 3);

    // Map to the format practice.js expects (global window.vocab)
    window.vocab = filtered.map(item => ({
        czech: item.czech,
        english: item.english,
        spanish: item.spanish,
        german: item.german
    }));

    // Trigger game logic once data is ready
    if (typeof initPractice === "function") initPractice();
    else if (typeof renderCard === "function") renderCard();
</script>

<script src="../js/translations.js"></script>
<script src="../js/language-selector.js"></script>
<script src="../js/practice.js"></script>

<script>
    const btnMap = {
        "prevBtn": "prev",
        "nextBtn": "next",
        "btn-vocab": "vocabulary",
        "btn-test": "test",
        "btn-home": "home",
        "btn-exerciseList": "exerciseList"
    };

    function applyPracticeTranslations() {
        if (!translations) return;

        const pageTitle = document.querySelector("title");
        if (pageTitle && translations.pageTitle) pageTitle.textContent = translations.pageTitle;

        const heading = document.getElementById("heading-practice");
        if (heading && translations["heading-past-tense"]) heading.textContent = translations["heading-past-tense"];

        for (const [id, key] of Object.entries(btnMap)) {
            const el = document.getElementById(id);
            if (el && translations.buttons && translations.buttons[key]) el.textContent = translations.buttons[key];
        }
    }

    document.addEventListener("DOMContentLoaded", () => {
        const savedLang = localStorage.getItem("selectedLanguage") || "en";
        if (typeof loadTranslations === "function") loadTranslations(savedLang);

        // SAFETY: Check if cards are empty because the module loaded late
        const retryInterval = setInterval(() => {
            if (window.vocab && window.vocab.length > 0) {
                if (typeof renderCard === "function") renderCard();
                else if (typeof showCard === "function") showCard();
                clearInterval(retryInterval);
            }
        }, 100);
    });
</script>

</body>
</html>